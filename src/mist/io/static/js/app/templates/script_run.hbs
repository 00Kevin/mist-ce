<div id="script-run"
    data-swipe-close="false"
    class="side-panel"
    data-role="panel"
    data-position="right"
    data-display="overlay"
    data-theme="c">

    <div data-role="header">
        <h1>Run script</h1>
    </div>

    <div data-role="content" data-theme="a">

        <div class="form-field">
            <label>Machine:</label>
            <div id="script-run-machine"
                data-role="collapsible"
                data-iconpos="right"
                data-collapsed-icon="arrow-d"
                data-expanded-icon="arrow-u"
                data-theme="a"
                class="mist-select">
                <h4>
                    {{#with Mist.scriptRunController.scriptToRun as |script|}}
                        {{#if script.machine}}
                            {{script.machine.name}}
                        {{else}}
                            Select
                        {{/if}}
                    {{/with}}
                </h4>
                <ul data-role="listview" data-theme="a">
                    {{#each Mist.backendsController.model as |backend|}}
                    {{#if backend.enabled}}
                        {{#each backend.machines.model as |machine|}}
                        {{#if machine.hasKeys}}
                            <li data-icon="false">
                                <a {{action "machineClicked" machine target=view}}>
                                    {{machine.name}}
                                </a>
                            </li>
                        {{/if}}
                        {{/each}}
                    {{/if}}
                    {{/each}}
                </ul>
            </div>
        </div>

        <div class="form-field">
            <label for="script-params">Parameters (optional):</label>
            {{view Mist.TextArea
                data-theme="a"
                id="script-params"
                value=Mist.scriptRunController.scriptToRun.parameters}}
        </div>

        {{#if Mist.scriptsController.runningScript}}
            <div class="ajax-loader"></div>
        {{/if}}

        <div class="ok-cancel" data-role="controlgroup" data-type="horizontal">
            <a class="ui-btn ui-btn-a ui-shadow ui-corner-all"
                {{action "backClicked" target=view}}>Back</a>
            <a id="new-script-ok" data-theme="d"
                class="{{if view.isReady '' 'ui-state-disabled'}} ui-btn ui-btn-d"
                {{action "runClicked" target=view}}>Run</a>
        </div>
    </div>
</div>
