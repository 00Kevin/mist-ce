<div id="home-page" data-role="page" class="ui-page-active ui-page">
    <!-- Page header -->
    <div class="ui-header ui-bar-b">
        <h1 class="ui-title">mist.io</h1>
        {{view "userMenu"}}
    </div>

    <!-- Page Body -->
    <div role="main" class="ui-content" data-theme="c">

        <!-- Add backend button -->
        <a id="add-backend-btn" class="ui-link ui-btn ui-btn-d ui-icon-plus
            ui-btn-icon-right ui-shadow ui-corner-all ui-mini"
            {{action "addBackend" target="view"}} data-mini="true">
                Add cloud
        </a>

        <!-- Backends list -->
        <div id="backend-buttons" data-role="controlgroup" data-type="horizontal"
            class="ui-controlgroup ui-controlgroup-horizontal ui-corner-all">
            {{#each Mist.backendsController.content}}
                {{view "backendButton" backendBinding="this"
                       class="ui-btn ui-input-btn ui-corner-all ui-shadow"}}
            {{/each}}
        </div>

        {{#if Mist.backendsController.length}}
        <div class="ui-grid-a ui-responsive">
            <div class="ui-block-a">
                <div class="ui-body">
                    <!-- Navigation -->
                    <ul class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
                        <!-- Machines link -->
                        <li class="ui-li-has-count ui-first-child">
                            <a class="ui-btn" href="#/machines">
                                <span class="ui-li-count ui-body-inherit">
                                    {{Mist.backendsController.machineCount}}
                                </span>
                                Machines
                            </a>
                        </li>

                        <!-- Images link -->
                        <li class="ui-li-has-count">
                            <a class="ui-btn" href="#/images">
                                <span class="ui-li-count ui-body-inherit">
                                    {{Mist.backendsController.imageCount}}
                                </span>
                                Images
                            </a>
                        </li>

                        <!-- Networks link -->
                        {{#if Mist.backendsController.hasNetworks}}
                        <li class="ui-li-has-count">
                            <a class="ui-btn" href="#/networks">
                                <span class="ui-li-count ui-body-inherit">
                                    {{Mist.backendsController.networkCount}}
                                </span>
                                Networks
                            </a>
                        </li>
                        {{/if}}

                        <!-- Keys link -->
                        <li class="ui-li-has-count">
                            <a class="ui-btn" href="#/keys">
                                <span class="ui-li-count ui-body-inherit">
                                    {{Mist.keysController.content.length}}
                                </span>
                                Keys
                            </a>
                        </li>

                        <!-- Scripts link -->
                        <li class="ui-li-has-count">
                            <a class="ui-btn" href="#/scripts">
                                <span class="ui-li-count ui-body-inherit">
                                    {{Mist.scriptsController.length}}
                                </span>
                                Scripts
                            </a>
                        </li>
                    </ul>
                </div>

            </div>

            <div class="ui-block-b">
                <div class="ui-body">
                {{#if Mist.monitored_machines.length}}
                    <ul class="ui-listview ui-listview-inset ui-corner-all ui-shadow incidents header">
                        <li class="ui-li-divider ui-bar-c ui-first-child">Incidents</li>
                        <li class="ui-li-divider ui-bar-c ui-last-child" style="display:none;"></li>
                    </ul>
                    <ul class="ui-listview ui-listview-inset ui-corner-all ui-shadow incidents">
                        {{#each Mist.openIncidents}}
                        <li class="ui-bar-b incident">
                            <a class="ui-icon-alert ui-btn ui-btn-icon-right"
                                {{action "incidentClicked" this target="view"}}>
                                <span class="machine">
                                    {{this.machine.name}}:
                                </span>
                                <span class="rule-condition">
                                {{#if this.ruleId}}
                                    {{this.rule.metric.name}} {{this.rule.operator.symbol}}
                                    {{this.rule.value}} {{this.rule.metric.unit}} for {{this.rule.aggregate.title}}
                                    value within {{this.rule.timeWindowToMins}} min(s)
                                {{/if}}
                                </span>
                                <span class="time">
                                    {{this.duration}}
                                </span>
                            </a>
                        </li>
                        {{/each}}
                        {{#each Mist.closedIncidents}}
                        <li class="ui-mini incident">
                            <a class="ui-icon-check ui-btn ui-btn-icon-right"
                                {{action "incidentClicked" this target="view"}}>
                                <span class="machine">
                                    {{this.machine.name}}:
                                </span>
                                <span class="rule-condition">
                                {{#if this.ruleId}}
                                    {{this.rule.metric.name}} {{this.rule.operator.symbol}}
                                    {{this.rule.value}} {{this.rule.metric.unit}} for {{this.rule.aggregate.title}}
                                    value within {{this.rule.timeWindowToMins}} min(s)
                                {{/if}}

                                </span>
                                for {{this.duration}}
                                <span class="time">{{this.closed}} ago </span>
                            </a>
                        </li>
                        {{/each}}
                    </ul>
                {{/if}}
                </div>
            </div>
        </div><!-- /grid-a -->

        {{view "graphList" actionProxyBinding="view"}}

        {{#if Mist.isCore}}
            <div data-role="collapsible" data-collapsed="false">
               <h4>Activity log</h4>
               {{view "logList"}}
            </div>
        {{/if}}
        {{/if}}
    </div>

    {{view "dialog"}}

    {{view "backendAdd"}}

    {{view "backendEdit"}}

</div>
