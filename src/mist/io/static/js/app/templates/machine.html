<div data-role="page" id="single-machine" data-theme="c"
    class="type-interior">

    <div data-role="header">

        <a href="#machines"
            data-icon="arrow-l"
            data-direction="reverse"
            class="ui-btn-left">Machines</a>

        <h1 id="single-machine-name">{{name}}</h1>

        <a href="#dialog-providers"
            data-rel="dialog"
            data-role="button"
            data-iconpos="notext"
            data-transition="slidedown"
            data-icon="check"
            {{bindAttr class="Mist.backendsController.state :state-providers"}}>Backends</a>

    </div>

    <div class="single-view-header">

        <h3 class="single-view-name">{{name}}</h3>

        <span class="single-view-icon-wrapper">
            <span id="single-view-provider-icon" {{bindAttr class="providerIconClass"}}></span>
        </span>

        <span class="single-view-icon-wrapper" {{bindAttr class="machine.image.type"}}>
            <span id="single-view-image-icon"></span>
        </span>

        <h3 id="single-view-state" {{bindAttr class="machine.state"}}>{{machine.state}}</h3>

    </div>

    <div data-role="content">

        <div data-role="collapsible" data-collapsed="false">

            <h3>Monitoring</h3>
                <div id="monitoring-wrapper" class="ui-btn-inner ui-corner-top ui-corner-bottom">

                {{#if machine.hasMonitoring}}
                <div id="cpuGraph"></div>
                <div id="loadGraph"></div>
                <div id="networkGraph"></div>
                <div id="diskGraph"></div>
                <div id="memoryGraph"></div>

                <h4 class="monitoring-rules-title">Rules</h4>

                <div class="add-rule-container">
                    <a href="#add-rule"
                        class="add-rule-button"
                        data-role="button"
                        data-icon="plus"
                        data-theme="b">Add</a>
                </div>

                <div class="rules-container">
                    <div class="rule-box">
                        <div class="rule-if">if</div>

                        <select class="rule-metric" data-icon="false"
                                data-native-menu="false" data-inline="true">
                            <option value="load">load</option>
                            <option value="cpu">cpu</option>
                            <option value="memory">memory</option>
                            <option value="disk">disk</option>
                            <option value="network">network</option>
                        </select>

                        <select class="rule-operator" data-icon="false"
                                data-native-menu="false" data-inline="true">
                            <option value="lt">&lt;</option>
                            <option value="gt">&gt;</option>
                        </select>

                        <input type="number" data-type="range" data-highlight="true" class="rule-value" value="60" min="0" max="100" />

                        <div class="rule-then">then</div>

                        <select class="rule-action"  data-icon="false"
                                data-native-menu="false" data-inline="true">
                            <option value="alert">alert</option>
                            <option value="reboot">reboot</option>
                            <option value="destroy">destroy</option>
                            <option value="launch">launch</option>
                            <option value="command">command</option>
                        </select>
                    </div>


                </div>

                <div class="monitoring-dialog-container">
                    <a href="#monitoring-dialog"
                        class="monitoring-button"
                        data-role="button"
                        data-icon="delete"
                        data-rel="popup"
                        data-theme="a"
                        data-transition="slidedown"
                        data-position-to="window">Disable Monitoring</a>
                    {{else}}

                <div class="monitoring-dialog-container">
                    <div class="monitoring-info">Monitoring is currently disabled</div>
                
                    <a href="#monitoring-dialog"
                        class="monitoring-button"
                        data-role="button"
                        data-icon="star"
                        data-rel="popup"
                        data-theme="b"
                        data-transition="slidedown"
                        data-position-to="window">Enable Monitoring</a>

                    <div class="ui-loader ui-corner-all ui-body-a ui-loader-verbose pending-monitoring">
                        <span class="ui-icon ui-icon-loading"></span>
                        <h1>Enabling monitoring</h1>
                    </div>
                    {{/if}}
                </div>
            </div>
        </div>

        <div data-role="collapsible" data-collapsed="false">

            <h3>Basic Info</h3>

            <table id="machine-basic-table">

                {{#if machine.tags}}
                <tr>
                    <td class="key">Tags</td>
                    <td class="value">
                        {{#each machine.tags}}
                        <span class="tag">{{this}}</span>
                        {{/each}}
                    </td>
                </tr>
                {{/if}}

                {{#if machine.uptime}}
                <tr>
                   <td class="key">Up and running for</td>
                   <td class="value">{{upFor}}</td>
                </tr>
                {{/if}}

                {{#each basicvars}}
                <tr>
                   <td class="key">{{key}}</td>
                   <td class="value">{{value}}</td>
                </tr>
                {{/each}}

            </table>

        </div>

        <div data-role="collapsible">

            <h3>Full metadata list</h3>

            <table id="machine-metadata">
                {{#each metadata}}
                <tr>
                   <td class="key">{{key}}</td>
                   <td class="value">{{value}}</td>
                </tr>
                {{/each}}
            </table>

        </div>

        <div class="bottom-padding"></div>

    </div>

    <div class="machines-footer" data-role="footer" data-theme="a">

        <div class="actions" data-role="controlgroup" data-type="horizontal">

            <a href="#dialog-shell"
                class="action-links"
                id="machines-button-shell"
                data-role="button"
                data-icon="gear"
                data-rel="popup"
                data-transition="slideup"
                {{bindAttr class="disabledShellClass"}}>Shell</a>

            <a href="#dialog-tags"
                class="action-links"
                id="machines-button-tags"
                data-role="button"
                data-icon="grid"
                data-rel="popup"
                data-transition="slideup"
                {{bindAttr class="disabledTagClass"}}>Tag</a>

            <a href="#dialog-single-power"
                class="action-links"
                id="machines-button-power"
                data-role="button"
                data-icon="mist-power"
                data-rel="popup"
                data-transition="slideup"
                {{bindAttr class="disabledPowerClass"}}>Power</a>
        </div>

    </div>
</div>
